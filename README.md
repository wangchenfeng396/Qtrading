# Qtrading é‡åŒ–äº¤æ˜“ç³»ç»Ÿ

è¿™æ˜¯ä¸€ä¸ªåŸºäº Python å’Œ ClickHouse çš„é«˜é¢‘é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸“æ³¨äº BTC/USDT çš„è¶‹åŠ¿å›è¸©ç­–ç•¥ã€‚

## ğŸ“ ç›®å½•ç»“æ„

*   `src/`: æ ¸å¿ƒä»£ç 
    *   `main.py`: å›æµ‹ä¸»ç¨‹åº (å…¥å£)
    *   `backtester.py`: å›æµ‹å¼•æ“ä¸èµ„é‡‘ç®¡ç†
    *   `strategy.py`: ç­–ç•¥é€»è¾‘ (EMA è¶‹åŠ¿ + å›è¸©)
    *   `live_bot.py`: å®ç›˜ä¿¡å·ç”Ÿæˆå™¨ (Live)
    *   `data_loader.py`: æ•°æ®åŠ è½½ä¸èšåˆ
    *   `config.py`: **ç³»ç»Ÿä¸»é…ç½®æ–‡ä»¶** (æŸ¥çœ‹ [é…ç½®è¯¦è§£](docs/configuration_guide.md))
*   `testnet/`: æ¨¡æ‹Ÿç›˜ç¯å¢ƒ
    *   `config.py`: æ¨¡æ‹Ÿç›˜ç‹¬ç«‹é…ç½®
    *   `run_simulation.py`: æ¨¡æ‹Ÿç›˜è¿è¡Œè„šæœ¬
*   `scripts/`: å·¥å…·è„šæœ¬
    *   `month_download_s_to_clickhouse.py`: ä¸‹è½½å†å²æ•°æ® (æŒ‰æœˆ ZIP)
    *   `day_download_s_to_clickhouse.py`: ä¸‹è½½è¡¥å…¨æ•°æ® (æŒ‰æ—¥ API)
    *   `test_clickhouse.py`: æ•°æ®åº“è¿æ¥æµ‹è¯•
*   `logs/`: è¿è¡Œæ—¥å¿— (è‡ªåŠ¨ç”Ÿæˆ)
*   `docs/`: æ–‡æ¡£è¯´æ˜
    *   `trading_strategy.md`: **äº¤æ˜“ç­–ç•¥è¯¦ç»†è¯´æ˜ä¹¦** (æ¨èé˜…è¯»)
    *   `configuration_guide.md`: å‚æ•°é…ç½®è¯¦è§£
    *   `testnet_guide.md`: æ¨¡æ‹Ÿç›˜ä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. æ•°æ®å‡†å¤‡
ç¡®ä¿æœ¬åœ°å®‰è£…å¹¶è¿è¡Œ ClickHouse (é»˜è®¤ç«¯å£ 8123)ã€‚

```bash
# æ–¹å¼ä¸€ï¼šä¸‹è½½å†å²æœˆä»½æ•°æ® (æ¨è)
python scripts/month_download_s_to_clickhouse.py --month 2024-01

# æ–¹å¼äºŒï¼šä¸‹è½½æŒ‡å®šæ—¥æœŸæ•°æ® (è¡¥å…¨)
python scripts/day_download_s_to_clickhouse.py --date 2026-01-06
```

### 3. è¿è¡Œå›æµ‹
```bash
# è¿è¡ŒæŒ‡å®šæ—¶é—´æ®µçš„å›æµ‹
python src/main.py --start 2024-01-01 --end 2024-01-07
```
è¿è¡Œåä¼šç”Ÿæˆäº¤äº’å¼æŠ¥å‘Š `backtest_report.html`ã€‚

### 4. å®ç›˜è¿è¡Œ (åå°æ¨¡å¼)
```bash
# å¯åŠ¨å®ç›˜æœºå™¨äºº (åå°è¿è¡Œï¼Œæ—¥å¿—è®°å½•åˆ° logs/live_bot.log)
./start_live.sh

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f logs/live_bot.log
```

### 5. æ¨¡æ‹Ÿç›˜å®æ“
```bash
# å¯åŠ¨æ¨¡æ‹Ÿç›˜ (åå°è¿è¡Œ)
./start_simulation.sh
```

### 6. è‡ªåŠ¨æ•°æ®è¡¥å…¨
```bash
# å¯åŠ¨æ¯æ—¥æ•°æ®ä¸‹è½½å™¨ (åå°è¿è¡Œ)
./start_download.sh
```

## ğŸ›  åå°è„šæœ¬ç®¡ç†

ç³»ç»Ÿæä¾›äº†ä¸‰ä¸ª Shell è„šæœ¬è¿›è¡Œåå°è¿è¡Œç®¡ç†ã€‚æ—¥å¿—åˆ†ä¸ºä¸¤å±‚ï¼š**åº”ç”¨æ—¥å¿—**ï¼ˆè®°å½•äº¤æ˜“é€»è¾‘ä¸ä¿¡å·ï¼‰å’Œ**æ§åˆ¶å°æ—¥å¿—**ï¼ˆè®°å½•ç³»ç»Ÿå¯åŠ¨ä¿¡æ¯ä¸åŸå§‹æŠ¥é”™ï¼‰ã€‚

| å¯åŠ¨è„šæœ¬ | åŠŸèƒ½è¯´æ˜ | åº”ç”¨æ—¥å¿— (ç»“æ„åŒ–) | æ§åˆ¶å°/æŠ¥é”™æ—¥å¿— (åŸå§‹) |
| :--- | :--- | :--- | :--- |
| `start_live.sh` | **å¯åŠ¨å®ç›˜æœºå™¨äºº** | `logs/live_bot.log` | `logs/console_live.log` |
| `start_simulation.sh` | **å¯åŠ¨æ¨¡æ‹Ÿç›˜** | `logs/live_bot.log` | `logs/console_sim.log` |
| `start_download.sh` | **å¯åŠ¨å¢é‡ä¸‹è½½** | `logs/download.log` | `logs/console_download.log` |

### å¸¸ç”¨æ—¥å¿—æ“ä½œ

*   **æŸ¥çœ‹æ ¸å¿ƒäº¤æ˜“ä¿¡å· (æ¨è)**:
    ```bash
    tail -f logs/live_bot.log
    ```
*   **æŸ¥çœ‹æ•°æ®åŒæ­¥è¿›åº¦**:
    ```bash
    tail -f logs/download.log
    ```
*   **å¯åŠ¨å¤±è´¥æ—¶æ’æŸ¥æŠ¥é”™**:
    ```bash
    # å¦‚æœ start_live.sh è¿è¡Œåç¨‹åºæ²¡åŠ¨é™ï¼Œæ£€æŸ¥è¿™ä¸ªæ–‡ä»¶
    cat logs/console_live.log
    ```

### åœæ­¢åå°è¿›ç¨‹
è„šæœ¬å¯åŠ¨æ—¶ä¼šæ˜¾ç¤ºè¿›ç¨‹ ID (PID)ã€‚è‹¥éœ€æ‰‹åŠ¨æŸ¥æ‰¾å¹¶åœæ­¢ï¼š
```bash
# æŸ¥æ‰¾æ­£åœ¨è¿è¡Œçš„æœºå™¨äºº
ps -ef | grep live_bot

# åœæ­¢è¿›ç¨‹ (å°† <PID> æ›¿æ¢ä¸ºå®é™…æ•°å­—)
kill <PID>
```

## ğŸ“Š ç­–ç•¥ç®€ä»‹
é‡‡ç”¨ **é¡ºåŠ¿éœ‡è¡å›å½’ (Trend Mean Reversion)** é€»è¾‘ï¼š
*   **è¶‹åŠ¿**: 1H EMA 100 è¿‡æ»¤å¤§åŠ¿ã€‚
*   **å…¥åœº**: 5m RSI è¶…ä¹°/è¶…å– + å¸ƒæ—å¸¦è§¦è½¨ + Kçº¿åè½¬ç¡®è®¤ã€‚
*   **é£æ§**: 2% å¤åˆ©ä»“ä½ + ATR åŠ¨æ€æ­¢æŸã€‚

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [docs/trading_strategy.md](docs/trading_strategy.md)ã€‚
